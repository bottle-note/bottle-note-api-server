# Block API ν…μ¤νΈ κ°€μ΄λ“

μ΄ λ””λ ‰ν† λ¦¬λ” `BlockTestController`μ μ°¨λ‹¨ κΈ°λ¥μ„ ν…μ¤νΈν•κΈ° μ„ν• HTTP νμΌλ“¤μ„ ν¬ν•¨ν•©λ‹λ‹¤.

## π”§ μ‚¬μ „ μ¤€λΉ„

1. **ν™κ²½ μ„¤μ •**: μ΄ μ»¨νΈλ΅¤λ¬λ” `local`, `dev`, `test` ν™κ²½μ—μ„λ§ λ™μ‘ν•©λ‹λ‹¤ (`prod` ν™κ²½μ—μ„λ” λΉ„ν™μ„±ν™”)
2. **ν™κ²½ λ³€μ**: IntelliJ HTTP Clientμ—μ„ `http-client.env.json` νμΌμ ν™κ²½μ„ μ„ νƒν•΄μ•Ό ν•©λ‹λ‹¤
   - `local`: http://localhost:30001
   - `dev`: http://localhost:30001  
   - `prod`: https://api.bottle-note.com/
3. **μΈμ¦**: Block API (`/api/v1/test/**`)λ” μΈμ¦μ΄ ν•„μ”ν•μ§€ μ•μµλ‹λ‹¤ (Spring Securityμ—μ„ `permitAll()` μ„¤μ •)
4. **ν† ν° (μ„ νƒμ‚¬ν•­)**: ν•„μ”μ‹ 01λ² νμΌμ ν† ν° λ°κΈ‰ APIλ¥Ό μ‚¬μ©ν•μ—¬ `accessToken` λ³€μλ¥Ό μ„¤μ •ν•  μ μμµλ‹λ‹¤

## π“ ν…μ¤νΈ νμΌ κµ¬μ„±

### 01-μ°¨λ‹¨_κ΄€κ³„_μƒμ„±.http
- **λ©μ **: μ°¨λ‹¨ κ΄€κ³„λ¥Ό μƒμ„±ν•λ” API ν…μ¤νΈ
- **μ—”λ“ν¬μΈνΈ**: `POST /api/v1/test/block/add`
- **νλΌλ―Έν„°**:
  - `blockerId`: μ°¨λ‹¨ν•λ” μ‚¬μ©μ ID (ν•„μ)
  - `blockedId`: μ°¨λ‹¨λ‹Ήν•λ” μ‚¬μ©μ ID (ν•„μ)  
  - `reason`: μ°¨λ‹¨ μ‚¬μ  (μ„ νƒ, κΈ°λ³Έκ°’: "ν…μ¤νΈ μ°¨λ‹¨")

### 02-μ°¨λ‹¨_μ—¬λ¶€_ν™•μΈ.http
- **λ©μ **: λ‘ μ‚¬μ©μ κ°„ μ°¨λ‹¨ μ—¬λ¶€λ¥Ό ν™•μΈν•λ” API ν…μ¤νΈ
- **μ—”λ“ν¬μΈνΈ**: `GET /api/v1/test/block/check`
- **νλΌλ―Έν„°**:
  - `blockerId`: μ°¨λ‹¨ν•λ” μ‚¬μ©μ ID
  - `blockedId`: μ°¨λ‹¨λ‹Ήν•λ” μ‚¬μ©μ ID

### 03-μ°¨λ‹¨_λ©λ΅_μ΅°ν.http
- **λ©μ **: νΉμ • μ‚¬μ©μκ°€ μ°¨λ‹¨ν• μ‚¬μ©μ λ©λ΅μ„ μ΅°νν•λ” API ν…μ¤νΈ
- **μ—”λ“ν¬μΈνΈ**: `GET /api/v1/test/block/list/{userId}`
- **κ²½λ΅ λ³€μ**: `userId` - μ°¨λ‹¨ λ©λ΅μ„ μ΅°νν•  μ‚¬μ©μ ID

### 04-μ°¨λ‹¨_ν†µκ³„_μ΅°ν.http
- **λ©μ **: νΉμ • μ‚¬μ©μμ μ°¨λ‹¨ ν†µκ³„λ¥Ό μ΅°νν•λ” API ν…μ¤νΈ
- **μ—”λ“ν¬μΈνΈ**: `GET /api/v1/test/block/statistics/{userId}`
- **κ²½λ΅ λ³€μ**: `userId` - ν†µκ³„λ¥Ό μ΅°νν•  μ‚¬μ©μ ID

### 05-μ°¨λ‹¨_κ΄€κ³„_ν•΄μ .http
- **λ©μ **: μ°¨λ‹¨ κ΄€κ³„λ¥Ό ν•΄μ ν•λ” API ν…μ¤νΈ
- **μ—”λ“ν¬μΈνΈ**: `DELETE /api/v1/test/block/remove`
- **νλΌλ―Έν„°**:
  - `blockerId`: μ°¨λ‹¨μ„ ν•΄μ ν•  μ‚¬μ©μ ID
  - `blockedId`: μ°¨λ‹¨ ν•΄μ  λ€μƒ μ‚¬μ©μ ID

### 06-μ°¨λ‹¨_ν•„ν„°_ν…μ¤νΈ.http
- **λ©μ **: `@BlockFilter` μ–΄λ…Έν…μ΄μ…μ΄ μ μ©λ APIμ—μ„ μ°¨λ‹¨λ μ‚¬μ©μμ λ°μ΄ν„°κ°€ ν•„ν„°λ§λλ”μ§€ ν…μ¤νΈ
- **μ—”λ“ν¬μΈνΈ**: `GET /api/v1/test/block/test-data/{userId}`
- **κ²½λ΅ λ³€μ**: `userId` - κ²½λ΅μ μ‚¬μ©μ ID (μ‹¤μ λ΅λ” μ‚¬μ©λμ§€ μ•μ)
- **ν—¤λ”**: `X-User-Id` - μ‹¤μ  μ”μ²­ν•λ” μ‚¬μ©μ ID (ν…μ¤νΈμ© SecurityContext μ„¤μ •)
- **νΉμ§•**: 
  - μ‹¤μ  λ¦¬λ·° κµ¬μ΅°μ™€ μ μ‚¬ν• μ‘λ‹µ λ°μ΄ν„° μ κ³µ
  - μ°¨λ‹¨ν• μ‚¬μ©μλ“¤μ λ°μ΄ν„°λ” "μ°¨λ‹¨λ μ‚¬μ©μμ κΈ€μ…λ‹λ‹¤"λ΅ λ§μ¤ν‚Ήλ¨
  - μ°¨λ‹¨λ μ‚¬μ©μμ λ‹‰λ„¤μ„μ΄ "μ°¨λ‹¨λ μ‚¬μ©μ"λ΅ λ³€κ²½λ¨
  - ν”„λ΅ν•„ μ΄λ―Έμ§€λ„ nullλ΅ μ²λ¦¬λ¨

### 07-μ „μ²΄_μ΄κΈ°ν™”_ν…μ¤νΈ.http
- **λ©μ **: μ „μ²΄ μ°¨λ‹¨ κ΄€κ³„ μ΄κΈ°ν™” API ν…μ¤νΈ (ν„μ¬ λΉ„ν™μ„±ν™”λ¨)
- **μ—”λ“ν¬μΈνΈ**: `DELETE /api/v1/test/block/clear`
- **μ°Έκ³ **: DB κΈ°λ°μΌλ΅ λ³€κ²½λμ–΄ μ•μ „μƒμ μ΄μ λ΅ λΉ„ν™μ„±ν™”λ κΈ°λ¥μ…λ‹λ‹¤

## π€ ν…μ¤νΈ μ‹λ‚λ¦¬μ¤ μμ‹

### κΈ°λ³Έ μ‹λ‚λ¦¬μ¤
1. **μ°¨λ‹¨ κ΄€κ³„ μƒμ„±**: μ‚¬μ©μ 1μ΄ μ‚¬μ©μ 2λ¥Ό μ°¨λ‹¨
2. **μ°¨λ‹¨ μ—¬λ¶€ ν™•μΈ**: 1 β†’ 2 μ°¨λ‹¨ ν™•μΈ (true), 2 β†’ 1 μ°¨λ‹¨ ν™•μΈ (false)
3. **μ°¨λ‹¨ λ©λ΅ μ΅°ν**: μ‚¬μ©μ 1μ μ°¨λ‹¨ λ©λ΅μ— μ‚¬μ©μ 2κ°€ ν¬ν•¨λλ”μ§€ ν™•μΈ
4. **μ°¨λ‹¨ ν•„ν„° ν…μ¤νΈ**: μ‚¬μ©μ 1λ΅ μ”μ²­ μ‹ μ‚¬μ©μ 2μ λ°μ΄ν„°κ°€ ν•„ν„°λ§λλ”μ§€ ν™•μΈ
5. **μ°¨λ‹¨ κ΄€κ³„ ν•΄μ **: μ‚¬μ©μ 1μ΄ μ‚¬μ©μ 2μ μ°¨λ‹¨μ„ ν•΄μ 
6. **μ°¨λ‹¨ μ—¬λ¶€ μ¬ν™•μΈ**: 1 β†’ 2 μ°¨λ‹¨ ν™•μΈ (false)

### κ³ κΈ‰ μ‹λ‚λ¦¬μ¤
1. **μƒνΈ μ°¨λ‹¨**: μ‚¬μ©μ 1κ³Ό μ‚¬μ©μ 2κ°€ μ„λ΅ μ°¨λ‹¨
2. **λ‹¤μ¤‘ μ°¨λ‹¨**: μ‚¬μ©μ 1μ΄ μ—¬λ¬ μ‚¬μ©μ(2, 3, 4)λ¥Ό μ°¨λ‹¨
3. **ν†µκ³„ ν™•μΈ**: κ° μ‚¬μ©μλ³„ μ°¨λ‹¨ ν†µκ³„ μ΅°ν
4. **ν•„ν„°λ§ ν™•μΈ**: μ°¨λ‹¨λ μ‚¬μ©μλ“¤μ λ°μ΄ν„°κ°€ λ¨λ‘ ν•„ν„°λ§λλ”μ§€ ν™•μΈ

## β οΈ μ£Όμμ‚¬ν•­

1. **ν™κ²½ μ ν•**: `prod` ν™κ²½μ—μ„λ” μ΄ APIλ“¤μ„ μ‚¬μ©ν•  μ μ—†μµλ‹λ‹¤
2. **λ°μ΄ν„° μ •ν•©μ„±**: μ‹¤μ  μ΄μ λ°μ΄ν„°μ™€ μ—°λ™λλ―€λ΅ ν…μ¤νΈ μ‹ μ£Όμκ°€ ν•„μ”ν•©λ‹λ‹¤
3. **μ‚¬μ©μ ID**: μ΅΄μ¬ν•μ§€ μ•λ” μ‚¬μ©μ IDλ΅ ν…μ¤νΈν•  κ²½μ° μμ™Έκ°€ λ°μƒν•  μ μμµλ‹λ‹¤
4. **μ „μ²΄ μ΄κΈ°ν™”**: μ•μ „μƒμ μ΄μ λ΅ λΉ„ν™μ„±ν™”λμ–΄ μμΌλ―€λ΅ κ°λ³„ ν•΄μ λ¥Ό μ‚¬μ©ν•΄μ•Ό ν•©λ‹λ‹¤

## π” μ‘λ‹µ ν•νƒ

λ¨λ“  APIλ” `GlobalResponse` ν•νƒλ΅ μ‘λ‹µν•©λ‹λ‹¤:

```json
{
  "success": true,
  "message": "μ„±κ³µ λ©”μ‹μ§€",
  "data": "μ‘λ‹µ λ°μ΄ν„°"
}
```

μ‹¤ν¨ μ‹:
```json
{
  "success": false,
  "message": "μ‹¤ν¨ λ©”μ‹μ§€",
  "data": null
}
```